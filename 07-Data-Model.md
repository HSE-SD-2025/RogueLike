# 7. Описание данных

## 7.1. Поток данных

1.  **Инициализация игры:** Загружаются конфигурации (артефакты, мутанты) и ресурсы (спрайты, тайлсеты). Создается объект `Player` (Сталкер). Генерируется стартовая локация "База".
2.  **Вылазка в Зону:** Состояние мира (положение мутантов, игрока) обновляется после каждого хода. При входе в новый сектор он генерируется процедурно.
3.  **Взаимодействие:** Изменение состояния `Entity` (HP, патроны) после каждого действия. Создание новых `Entity` (лут, эффекты) и их добавление в мир.

## 7.2. Сохранение (Персистентность)

*   **Формат:** JSON. Легко читается и отлаживается.
*   **Триггер:** Сохранение доступно только на локации "База".
*   **Данные для сохранения:** Вся необходимая информация для полного восстановления игровой сессии: состояние игрока, исследованные сектора, состояние базы, активные квесты.
*   При перманентной смерти файл сохранения удаляется.

### Пример структуры файла сохранения (`savegame.json`)

```json
{
  "game_version": "0.1.0",
  "save_date": "2023-10-28T10:00:00Z",
  "player_entity": {
    "id": 1,
    "name": "Бывалый",
    "components": {
      "PositionComponent": { "x": 5, "y": 12, "sector_id": "base" },
      "RenderableComponent": { "spriteId": "player_main", "layer": 2 },
      "StatsComponent": { "hp": 85, "maxHp": 100, "radiation": 15 },
      "InventoryComponent": {
        "items": [
          { "id": 101, "name": "Аптечка" },
          { "id": 102, "name": "Антирад" },
          { "id": 201, "name": "АКМ-74/2У" }
        ]
      },
      "EquipmentComponent": {
        "artifactSlots": [ 
          { "id": 501, "name": "Артефакт 'Капля'" }
        ],
        "armor": { "id": 301, "name": "Куртка новичка" },
        "weapon": { "id": 201, "name": "АКМ-74/2У" }
      }
    }
  },
  "world_state": {
    "known_sectors": ["base", "sector_01_forest", "sector_02_swamp"],
    "active_quests": [
      { "id": "q1_find_artifact", "status": "in_progress" }
    ]
  }
}
```
